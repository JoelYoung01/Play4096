name: Continuous Integration / Continuous Deployment

on:
  push:
    branches:
      - main

jobs:
  BuildApp:
    uses: ./.github/workflows/BuildApp.yml
    with:
      image_name: ${{ vars.IMAGE_NAME }}
    secrets:
      GOOGLE_CLIENT_ID: ${{ secrets.GOOGLE_CLIENT_ID }}
      DATABASE_URL: ${{ secrets.DATABASE_URL }}

  DeployApp:
    needs: BuildApp
    uses: JoelYoung01/Templates/.github/workflows/DeployWebhook.yaml@v0.1.2
    with:
      app_name: Play4096
    secrets:
      WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
      WEBHOOK_SECRET: ${{ secrets.WEBHOOK_SECRET }}
